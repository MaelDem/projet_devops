name : Pipeline

on:
  push : 
    branches : pipeline
    paths : 
      - 'docker-compose.yml' 
      - 'backend/**'
      - 'frontend/**'

jobs : 
  linting : 
    runs-on : ubuntu-latest
  
    steps : 
      - name : Checkout branch 
        uses : actions/checkout@v4
        with: 
          fetch-depth: 0

      - name : Setup Bun
        uses : oven-sh/setup-bun@v2

      - name : Install dependencies
        run : bun install
      
      - name : Run Linters
        run : bun run check
        run : bun run ci

      - name: Commit changes if any
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git diff --exit-code || {
            echo "Changes detected. Committing changes..."

              git config --global user.name "github-actions"
              git config --global user.email "actions@github.com"

              git add .
              git commit -m "Apply code formatting and linting fixes"
              git push origin HEAD
            }

      

  
